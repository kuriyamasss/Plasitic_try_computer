# 产品开发费用统计系统 - GUI版本使用说明

## 🚀 快速开始

### 启动GUI程序
```bash
python gui_main.py
```

## 📋 主要功能

### 1. **主界面**
- **表格显示**：所有费用记录以表格形式展示
- **搜索功能**：右上角搜索框支持实时搜索
- **状态栏**：底部显示当前状态和操作结果

### 2. **功能按钮**
- **添加记录**：打开费用记录添加对话框
- **刷新**：重新加载数据
- **删除选中**：删除选中的记录
- **查看统计**：显示费用统计信息
- **导出数据**：导出为Excel或CSV格式

### 3. **菜单栏**
- **文件**：导出数据、退出程序
- **数据**：添加记录、刷新、查看统计
- **公式**：管理计算公式
- **帮助**：关于程序和帮助信息

## 🎯 核心功能详解

### 添加费用记录
1. 点击"添加记录"按钮或菜单中的"添加费用记录"
2. 在弹出的对话框中填写信息：
   - **费用类型**：选择人力、材料、设备或其他
   - **费用名称**：输入费用描述
   - **计算公式**：选择预定义或自定义公式
   - **参数输入**：根据公式输入相应参数
   - **或直接输入金额**：手动输入总金额
   - **其他信息**：数量、单价、日期、备注（可选）
3. 点击"计算"按钮验证金额
4. 点击"保存"完成添加

### 数据操作
- **查看详情**：双击表格中的记录查看完整信息
- **删除记录**：选中记录后点击"删除选中"按钮
- **搜索记录**：在搜索框中输入关键词实时过滤

### 费用统计
点击"查看统计"按钮显示：
- 总体统计（总记录数、总费用、平均费用等）
- 按类型统计（各类型费用占比）

### 数据导出
点击"导出数据"按钮：
1. 选择导出格式（Excel或CSV）
2. 选择保存位置和文件名
3. 系统自动生成包含统计摘要的文件

### 公式管理
从菜单选择"公式"→"管理计算公式"：
- 查看所有可用公式
- 区分预定义公式和自定义公式
- 添加/删除自定义公式功能（待完善）

## 🔧 技术特点

### 界面设计
- **Tkinter框架**：Python内置，无需额外安装
- **现代化布局**：表格+按钮+菜单的经典设计
- **响应式搜索**：实时过滤表格数据
- **对话框交互**：友好的表单输入体验

### 数据管理
- **重用核心模块**：基于现有的数据库和业务逻辑
- **实时同步**：操作后自动刷新表格
- **错误处理**：友好的错误提示和信息反馈

### 导出功能
- **多种格式**：支持Excel(.xlsx)和CSV(.csv)
- **统计摘要**：导出文件包含详细统计信息
- **文件管理**：导出到指定位置

## 📁 文件结构

```
产品开发费用统计系统/
├── gui_main.py          # GUI主程序
├── database.py          # 数据库操作（重用）
├── expense_manager.py   # 费用管理（重用）
├── export_manager.py    # 导出功能（重用）
├── config.py           # 配置（重用）
├── main.py             # 原始命令行版本
├── README.md           # 项目说明
└── requirements.txt    # 依赖包
```

## 🎨 界面预览

### 主界面
```
┌─────────────────────────────────────────────────────────────┐
│ 文件 数据 公式 帮助                                        │
├─────────────────────────────────────────────────────────────┤
│ [添加记录] [刷新] [删除选中] [查看统计] [导出数据]    搜索:│
├─────────────────────────────────────────────────────────────┤
│ ID  日期       类型    名称        数量 单价 总金额  备注  │
│ 1   2025-02-03 人力成本 开发工时   40   200  8000.00       │
│ 2   2025-02-02 材料费   PCB板      10   50   500.00        │
│ 3   2025-02-03 设备费   3D打印机   5    100  500.00        │
└─────────────────────────────────────────────────────────────┘
```

### 添加记录对话框
```
┌─────────────────────────────────────┐
│        添加费用记录                  │
├─────────────────────────────────────┤
│ 费用类型: [人力成本 ▼]              │
│ 费用名称: [________________________]│
│ 计算公式: [人力成本 ▼]              │
│ 参数:                               │
│   hours: [____] hourly_rate: [____] │
│ 或直接输入金额: [________]          │
│ 数量 (可选): [________]             │
│ 单价 (可选): [________]             │
│ 日期 (YYYY-MM-DD): [__________]    │
│ 备注 (可选): [____________________] │
│                                     │
│        总金额: 0.00                  │
│                                     │
│      [计算] [保存] [取消]           │
└─────────────────────────────────────┘
```

## ⚠️ 注意事项

1. **首次运行**：如果数据库不存在会自动创建
2. **公式计算**：选择公式后需要输入相应参数
3. **数据导出**：导出文件保存在`exports/`目录
4. **搜索功能**：支持所有列的内容搜索
5. **错误处理**：出现错误会有明确的提示信息

## 🔄 与命令行版本的区别

| 功能 | 命令行版本 | GUI版本 |
|------|------------|----------|
| 界面 | 文本菜单 | 图形界面 |
| 操作 | 键盘输入 | 鼠标点击 |
| 数据显示 | 文本表格 | 图形表格 |
| 搜索功能 | 无 | 实时搜索 |
| 导出界面 | 命令行交互 | 文件对话框 |

## 🚧 待完善功能

1. **完整的公式管理**：添加/编辑/删除自定义公式
2. **数据导入**：从Excel/CSV文件导入数据
3. **图表展示**：费用分布的图表显示
4. **主题切换**：支持深色/浅色主题
5. **数据备份**：数据库备份和恢复功能

## 📞 帮助和支持

1. **查看关于信息**：点击"帮助"→"关于"
2. **查看详细统计**：点击"查看统计"按钮
3. **导出问题**：确保已安装pandas和openpyxl依赖
4. **运行错误**：检查Python版本(≥3.6)和依赖包

---

**🎉 现在您可以开始使用GUI版本的产品开发费用统计系统了！**